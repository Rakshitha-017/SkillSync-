<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Login - SkillPortal</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script> tailwind.config = { darkMode: 'class' } </script>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-100">
  <div class="max-w-md mx-auto mt-20 px-4">
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow p-6">
      <h2 id="title" class="text-2xl font-bold mb-4"></h2>
      <form id="authForm" class="space-y-4">
        <input id="email" type="email" required placeholder="Email" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-transparent"/>
        <input id="pass" type="password" required placeholder="Password" class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-transparent"/>
        <button class="w-full bg-indigo-600 text-white py-2 rounded-lg hover:bg-indigo-700">Continue</button>
      </form>
      <p class="text-sm mt-3 text-center">
        <span id="switchText"></span> <a id="switchLink" class="text-indigo-600 font-semibold cursor-pointer"></a>
      </p>
      <p id="error" class="text-red-500 text-sm mt-2"></p>
    </div>
  </div>
  <!-- ===== end of <body> ===== -->
<script src="js/app.js"></script>
<script>
  const params = new URLSearchParams(location.search);
  const role = params.get('role');
  const title = document.getElementById('title');
  const switchText = document.getElementById('switchText');
  const switchLink = document.getElementById('switchLink');
  const error = document.getElementById('error');

  if (role === 'recruiter') {
    title.textContent = 'Recruiter Login';
    document.getElementById('switchText').style.display = 'none';
  } else {
    let mode = 'login';
    function setMode(m) {
      mode = m;
      title.textContent = mode === 'login' ? 'Student Login' : 'Student Sign-up';
      switchText.textContent = mode === 'login' ? 'New user?' : 'Already have an account?';
      switchLink.textContent = mode === 'login' ? 'Sign up' : 'Login';
    }
    setMode('login');
    switchLink.onclick = () => setMode(mode === 'login' ? 'signup' : 'login');
  }

  document.getElementById('authForm').onsubmit = e => {
    e.preventDefault();
    const email = document.getElementById('email').value.trim();
    const pass = document.getElementById('pass').value;
    const db = getDB();
    if (role === 'recruiter') {
      if (db.recruiters[email] && db.recruiters[email].password === pass) {
        localStorage.setItem('user', JSON.stringify({email, role}));
        location.href = 'dashboard.html?role=recruiter';
      } else error.textContent = 'Invalid recruiter credentials';
    } else {
      if (mode === 'signup') {
        if (db.students[email]) { error.textContent = 'Email exists'; return; }
        db.students[email] = {password: pass, course: '', score: 0, progress: 0};
        setDB(db);
      }
      if (!db.students[email] || db.students[email].password !== pass) {
        error.textContent = 'Invalid student credentials'; return;
      }
      localStorage.setItem('user', JSON.stringify({email, role}));
      // =====  NEW LANDING  =====
      location.href = 'student-landing.html';
    }
  };
</script>
</body>
</html>
</body>
</html>